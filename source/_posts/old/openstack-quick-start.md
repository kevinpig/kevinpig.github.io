layout: post
title: Openstack私有云快速帮助
date: 2015-09-11 10:40:55
tags:
 - Openstack
categories:
 - 云计算
---

# Openstack私有云

Openstack作为一个基于存储,网络,计算虚拟化技术上的IaaS管理平台,使大家可以方便获取自己需要的计算和存储资源.

## 云主机

云主机服务是云计算中最基础的服务,像传统物理机一样,云主机可以实时的添加或删除网卡,硬盘,更改主机CPU/内存等,也可以通过VNC终端在无网络下管理云主机.

### 核心概念

* 云主机(Instance)
  指一个镜像在制定CPU和内存配置下运行的一台云主机,具有一般主机的正常功能

* 镜像(Image)
  是云主机使用的根分区或系统盘,用户可以快速地通过镜像复制出一台云主机,免除了传统冗长的装机过程.

* 配置(Flavor)
  配置是指CPU和内存的某个配置,在Openstack原生UI中如果需要创建一个云主机,必须指定一个配置.

* 安全组(Security Group)
  指针对云主机的虚拟网卡的安全策略. 安全组包含一组白名单安全组规则,一个安全组规则允许某一特定数据包流入,流出虚拟网卡.

* 密钥(Key Pair)
  用于Linux云主机安全地通过SSH登录时使用.

<!--more-->

### 相关操作

支持的云主机的操作有:
 * 开机/关机/重启
 * 删除
 * 绑定/解帮浮动IP
 * 修改安全组
 * 调整云主机
 * **动态迁移(Live Migration)**

## 云硬盘

云硬盘是为云主机提供持久化的块存储服务,云硬盘使用了多种技术,底层基于Ceph分布式文件系统,使用多重副本的技术,把数据实时复制到多台服务上,即使有服务器发生故障,也可以保证数据的可靠性和可用性. 云硬盘可以随时挂载到云主机上,而且云硬盘和云主机相互独立,云硬盘可以自由挂载到任意云主机上,每个云主机可以挂载多个云硬盘,而且云硬盘可以随行进行扩容以及进行快照操作.

## 云存储

云存储是指基于支持PB基本存储分布式文件系统之上,提供Restful Api接口的存储服务.一般的云存储接口包括Swift,或者S3接口规范.

# 快速帮助

## 创建windows虚拟机
1. http://10.6.13.1 使用正确的用户名和密码登录Openstack的Dashboard
2. 在左侧导航栏选择镜像, 这里有平台提供的镜像,我们选择window 2008的Image,然后点击运行,会弹出启动云主机界面

![startup_cloud_machine](/images/openstack-quick-start/startup_computer.png)

输入要创建的云主机名称以及选择云主机的类型,然后点击运行
3. 在实例界面可以看到我们创建的云主机,当状态为运行中时,单击我们创建的云主机名称Url,通过云主机控制台,我们可以使用WebVNC远程到我们的云主机上.
![](/images/openstack-quick-start/webvnc.png)
4. 第一次创建云主机,需要执行一些配置工作,以及用户登录修改自己的密码.
5. 默认创建的云主机和公司的大网是不通的,如果需要使用windows mstsc远程登录到云主机中,需要首先绑定Floating Ip. 在实例界面,最右侧Actions选择绑定浮动IP,成功后在IP地址栏会多一个10.6.X.X网段的IP地址.
6. 通过WebVNC界面开启Windows 远程服务 (镜像默认开启,请double check)
7. 在导航栏访问&安全中创建一个安全组,容许所有RDP协议.以及根据自己需要开通相应的TCP或者UDP端口.默认default安全组开启了RDP的3389端口
![](/images/openstack-quick-start/security_rule.png)
8. 在Action中选择'编辑安全组'确保你创建的安全组(或者默认default)已经加入了云主机的安全组.
9. 通过远程桌面链接的我们创建的虚拟机上.

## 挂在云硬盘
1. 在左侧导航栏选择云硬盘-创建云硬盘,填写名称以及大小,其他可以空白
2. 右端Actions-编辑挂载,选择我们创建的云主机
3. 远程到我们的云主机上计算机管理 -> 磁盘管理 --> 右键联机 --> 右键初始化磁盘 --> 创建卷. 成功后我们就可以看到硬盘已经挂载到我们的云主机上了.

![add_cloud_disk](/images/openstack-quick-start/add_cloud_disk.png)

![add_cloud_disk_init](/images/openstack-quick-start/add_cloud_disk_init.png)

# 常见问题
1. 云硬盘和虚拟机根磁盘有什么区别?
> 虚拟机创建的根磁盘是临时存储,上面的数据在虚拟机被删除后就清除了.而云硬盘数据作为持久化存储可以重新挂载到新的虚拟机中使用.

2. 为什么ping不通创建的虚拟机
> 确保需要获取了Floating IP 地址以及确保安全组中ICMP协议是被容许的.
